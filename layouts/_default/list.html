{{ define "main" }}
{{ $pages := .Pages }}
<!-- _default/list.html is used by homepage, posts/ and links/ -->

 <!-- if on homepage filter entries of type blog (which includes
	 posts&links) by most recent date. -->
{{ if .IsHome }}
	{{ $pages = where .Site.Pages.ByDate.Reverse "Type" "eq" "blog" }}
{{ else if eq .Section "posts" }}
	<!-- .Site.Pages includes parent folder content/posts as entry, just .Pages only shows children of it -->
  {{ $pages = where .Pages.ByDate.Reverse "Section" "eq" "posts" }}
{{ else if eq .Section "links" }}
  {{ $pages = where .Pages.ByDate.Reverse "Section" "eq" "links" }}
{{ end }}


 <!-- fix for double entries with pagination, also 15 entries/page
	 instead of 30 (set in hugo.toml for tags) -->
 {{ $paginator := .Paginate $pages 15 }}

	<div class="mx-auto max-w-[45rem]">
		<section>
			<p>Welcome to my blog</p>
		</section>
		<main>
			<!-- loop pages start -->
			{{ range $paginator.Pages }}
				<article>
				<h2><a href="{{ if eq .Section "links" }}{{ .Params.linkUrl }}{{ else }}{{ .RelPermalink }}{{ end }}">{{ .LinkTitle }}</a></h2>
				<time pubdate="{{ .Date.Format "2006-01-02" }}" datetime="{{ .Date.Format "2006-01-02T15:04:05Z" }}" data-pagefind-meta="{{ .Date.Format "date:2006-01-02" }}" data-pagefind-sort="{{ .Date.Format "date:2006-01-02" }}">{{ .Date | time.Format "Monday, Jan 2, 2006" }}</time>

				<!-- loop tags start -->
				{{ with .Params.tags }}
				<ul id="tags">
					{{ range . }}
					<li><a href="{{ "/tags/" | relLangURL }}{{ . | urlize }}">{{ . }}</a></li>
					{{ end }}
				</ul>
				<!-- loop tags end -->
				{{ end }}
				<!-- If post contains cover img display it-->
				{{ if .Params.cover }}
					{{ $title := replaceRE "[^a-zA-Z0-9]+" "-" .Title | lower }}
					<img src="{{ printf "%s/%s/%s-cover.jpg" .Section $title .Params.i | relLangURL }}" alt="Cover image" loading="lazy" class="w-full m-0">
				{{ end }}
				<p>{{ .Summary }}</p>
				<a href="{{ .RelPermalink }}" class="text-accent"><span>Read more</span></a>
				<!-- loop pages end -->
				</article>
			{{ end }}
		</main>
		<!-- next/prev links -->
		{{ partial "pagination.html" . }}
	</div>
{{ end }}
